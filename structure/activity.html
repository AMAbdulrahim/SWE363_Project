<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>activity</title>
    <!-- <link rel="stylesheet" href="/style/VAE.css"> -->
    <link rel="stylesheet" href="/style/HeaderFooter.css">
    <link rel="stylesheet" href="/style/Activity.css">
    <!-- <link rel="stylesheet" href="/style/profile.css"> -->
    <script src="/script/userData.js"></script>


</head>
<body>
    <header>
        
        <div style="display:flex">
            <a href="" id="logout"><img src="./images/images.png" id="icon"></a>
           <h1  id="logo-name">Hi, <span id="profileName">Fname</span>!</h1>
        </div>
        <div class="header-bar">
          <div>
                <a href="/ViewAvailableEvents.html"><button id="header-events" class="header-bar-buttons">Events</button></a>
          </div>
          <div>
                <a href="/activity.html"><button id="header-activity" class="header-bar-buttons">Activity</button></a>
          </div>
          <div> 
                <a href="/settings.html"><button id="header-settings" class="header-bar-buttons">Settings</button></a>
        </div>
        </div>
        <div class="header-select" >
            <select class="header-select-buttons" id="changePageSelect" onchange="redirectToPage()">
                    <option value="/ViewAvailableEvents.html">Events</option>
                    <option value="/activity.html">Activity</option>
                    <option value="/settings.html">Settings</option>
              </select>
        </div>

    </header>

    <main>
        <div class="profile-info">
            <div class="profile-img">
                <img id="profileImg" src="/images/pfp.png" alt="">
            </div>
            <div class="profile-name">
                <h2 id="profileName2">Fname Lname</h2>
            </div>
            <div class="profile-email">
                <h3 id="profileEmail">
                    example@hotmail.com
                </h3>
            </div>
            <div class="profile-hours">
                <h3>Completed Hours: <span id="completedHours">00</span></h3>
            </div>
        </div>
        <div class="graph">
            <html>
  <head>
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <script type="text/javascript">
      google.charts.load('current', {'packages':['bar']});
      google.charts.setOnLoadCallback(drawStuff);

      function drawStuff() {
        var data = new google.visualization.arrayToDataTable([
          ['Opening Move', 'Hours'],
          ["Jan", 12],
          ["Feb", 9],
          ["Mar", 8],
          ["Apr", 14],
          ['may', 3],
          ["Jan",7],
          ["Jul",6],
          ["Aug",5],
          ["Sep",9],
          ["Oct",17],
          ["Nov",4],
          ["Dec",12]
        ]);

        var options = {
          title: 'Activity Hours',
          width: 900,
          legend: { position: 'none' },
          chart: { title: 'Activity Hours'},
          bars: 'virticall', // Required for Material Bar Charts.
          axes: {
            x: {
              0: { side: 'top', label: 'Months'} // Top x-axis.
            }
          },
          bar: { groupWidth: "2px" }
        };

        var chart = new google.charts.Bar(document.getElementById('top_x_div'));
        chart.draw(data, options);
      };
    </script>
  </head>
  <body>
    <div id="top_x_div" style="width: 50vw; height:70vh;"></div>
  </body>
</html>

        </div>
    </main>

    <footer>
        <div class="footer-contact">
    
            <label id="contact" for="">contact us</label>
            <a href="mailto:swe363.26.project@gmail.com" target="_blank"><img src="/images/email_icon.png" ></a>
            <a href="https://www.instagram.com/" target="_blank"><img src="/images/instagram_icon.png" ></a>
            <a href="https://twitter.com/" target="_blank"><img src="/images/twitter_icon.png" ></a><br>
            
        </div>
    
        <code>
            <a href="#" class="scrollup">Scroll</a>
        </code>
        
    </footer> 


    <script>
        document.addEventListener('DOMContentLoaded', function() {
        const logoutLink = document.getElementById('logout');

        logoutLink.addEventListener('click', function(event) {
            event.preventDefault(); // Prevent the default link behavior

            // Clear session storage
            sessionStorage.clear();

            // Redirect to the homepage
            window.location.href = './index.html';
        });
    });
      function redirectToReview() {
          window.location.href = "review.html";
      }
      document.addEventListener('DOMContentLoaded', function() {
        var userDataJSON = sessionStorage.getItem('userData');
    if (userDataJSON) {
        var userData = JSON.parse(userDataJSON);                        
        var userId1 = userData._id;
    }
    const userId = userId1;

    if (!userId) {
        alert('User not authenticated');
        return;
    }

    fetch(`http://localhost:8000/user/${userId}/monthlyActivity`)
        .then(response => {
            if (!response.ok) {
                throw new Error('Failed to fetch monthly activity');
            }
            return response.json();
        })
        .then(activityData => {
            drawActivityChart(activityData);
        })
        .catch(error => {
            console.error('Error fetching monthly activity:', error);
            alert('Failed to load activity data');
        });
});

function drawActivityChart(activityData) {
    google.charts.load('current', {'packages':['bar']});
    google.charts.setOnLoadCallback(() => {
        var data = new google.visualization.DataTable();

        
        var data = new google.visualization.arrayToDataTable([
          ['Opening Move', 'Hours'],
          ["Jan", 0],
          ["Feb", 0],
          ["Mar", 0],
          ["Apr", 0],
          ['may', 0],
          ["Jan",0],
          ["Jul",0],
          ["Aug",0],
          ["Sep",0],
          ["Oct",0],
          ["Nov",0],
          ["Dec",0]
        ]);
        Object.keys(activityData).forEach(month => {
            data.addRow([month, activityData[month]]);
        });

        var options = {
            title: 'Activity Hours',
            width: 900,
            legend: { position: 'none' },
            chart: { title: 'Activity Hours'},
            bars: 'vertical',
            axes: {
                x: {
                    0: { side: 'top', label: 'Months'} // Top x-axis.
                }
            },
            bar: { groupWidth: "90%" }
        };

        var chart = new google.charts.Bar(document.getElementById('top_x_div'));
        chart.draw(data, options);
    });
}


  </script>
</body>
</html>